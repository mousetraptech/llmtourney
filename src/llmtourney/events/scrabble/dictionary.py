"""Scrabble dictionary â€” TWL06 loader with fallback common-words list."""

from __future__ import annotations

from pathlib import Path

_DATA_DIR = Path(__file__).parent / "data"
_TWL06_PATH = _DATA_DIR / "twl06.txt"

# ~500 common short Scrabble words as fallback if TWL06 is unavailable.
# Includes all valid 2-letter words plus high-frequency 3-5 letter words.
_FALLBACK_WORDS = """
AA AB AD AE AG AH AI AL AM AN AP AR AS AT AW AX AY
BA BE BI BO BY
DA DE DO
ED EF EH EL EM EN ER ES ET EW EX
FA FE
GI GO
HA HE HI HM HO
ID IF IN IS IT
JO
KA KI
LA LI LO
MA ME MI MM MO MU MY
NA NE NO NU
OD OE OF OH OI OK OM ON OP OR OS OW OX OY
PA PE PI PO
QI
RE
SH SI SO
TA TI TO
UH UM UN UP US UT
WE WO
XI XU
YA YE YO
ZA
AAH AAL AAS ABA ABO ABS ABY ACE ACT ADD ADO ADS ADZ AFF AFT AGA AGE
AGO AGS AHA AHI AHS AID AIM AIN AIR AIS AIT ALA ALB ALE ALL ALP ALS
ALT AMA AMI AMP AMU ANA AND ANE ANI ANT ANY APE APO APP APT ARB ARC
ARE ARF ARK ARM ARS ART ASH ASK ASP ASS ATE ATT AUK AVA AVE AVO AWA
AWE AWL AWN AXE AYE AYS AZO BAD BAG BAH BAM BAN BAP BAR BAS BAT BAY
BED BEE BEG BEL BEN BES BET BEY BIB BID BIG BIN BIS BIT BIZ BOA BOB
BOD BOG BOP BOS BOT BOW BOX BOY BRA BRO BUB BUD BUG BUM BUN BUP BUR
BUS BUT BUY CAB CAD CAM CAN CAP CAR CAT CAW CEE CEL CEP CHI CIG CIS
COB COD COG COL CON COO COP COR COS COT COW COX COY COZ CRU CRY CUB
CUD CUE CUP CUR CUT CWM DAB DAD DAG DAH DAK DAL DAM DAP DAW DAY DEB
DEE DEL DEN DEV DEW DEY DIB DID DIE DIF DIG DIM DIN DIP DIS DIT DOC
DOE DOG DOL DON DOP DOR DOS DOT DOW DRY DUB DUD DUE DUG DUH DUN DUO
DUP DYE EAR EAT EAU EEL EGG EGO EKE ELD ELF ELK ELL ELM EME EMS EMU
END ENG ENS EON ERA ERE ERG ERN ERR ERS ESS ETA ETH EVE EWE EYE FAB
FAD FAN FAR FAT FAX FAY FED FEE FEH FEM FEN FER FES FET FEU FEW FEY
FEZ FIB FID FIE FIG FIN FIR FIS FIT FIX FIZ FLU FLY FOB FOE FOG FOH
FON FOP FOR FOU FOX FOY FRO FRY FUB FUD FUG FUN FUR GAB GAD GAE GAG
GAL GAM GAN GAP GAR GAS GAT GAY GED GEE GEL GEM GEN GET GEY GHI GIB
GID GIE GIG GIN GIP GIT GNU GOA GOB GOD GOO GOR GOS GOT GOX GUL GUM
GUN GUP GUS GUT GUV GUY GYM GYP HAD HAE HAG HAH HAJ HAM HAO HAP HAS
HAT HAW HAY HEH HEM HEN HEP HER HES HET HEW HEX HEY HIC HID HIE HIM
HIN HIP HIS HIT HOB HOD HOE HOG HOP HOT HOW HOY HUB HUE HUG HUH HUM
HUN HUP HUT ICE ICH ICK ICY IDS IFF IFS IGG ILK ILL IMP INK INN INS
ION IRE IRK ISM ITS IVY JAB JAG JAM JAR JAW JAY JEE JET JIB JIG JIN
JOB JOE JOG JOT JOW JOY JUG JUN JUS JUT KAB KAE KAF KAS KAT KAY KEA
KED KEF KEG KEN KEP KEX KEY KHI KID KIN KIP KIR KIS KIT KOA KOB KOI
KOP KOR KOS KUE LAB LAC LAD LAG LAM LAP LAS LAT LAV LAW LAX LAY LEA
LED LEE LEG LEI LEK LES LET LEU LEV LEX LEY LIB LID LIE LIN LIP LIS
LIT LOG LOO LOP LOT LOW LOX LUG LUV LYE MAC MAD MAE MAG MAN MAP MAR
MAS MAT MAW MAX MAY MED MEL MEM MEN MET MEW MID MIG MIL MIM MIR MIS
MIX MOA MOB MOC MOD MOG MOL MOM MON MOO MOP MOR MOS MOT MOW MUD MUG
MUM MUN MUS MUT NAB NAE NAG NAH NAM NAN NAP NAW NAY NEE NET NEW NIB
NIL NIM NIP NIT NIX NOB NOD NOG NOM NOO NOR NOS NOT NOW NUB NUN NUS
NUT OAF OAK OAR OAT OBE OBI OCA ODD ODE ODS OES OFF OFT OHM OHO OHS
OIL OKA OKE OLD OLE ONE ONO ONS OOH OOT OPE OPS OPT ORA ORB ORC ORE
ORS ORT OSE OUD OUR OUT OVA OWE OWL OWN OXO OXY PAC PAD PAH PAL PAM
PAN PAP PAR PAS PAT PAW PAX PAY PEA PEC PED PEE PEG PEH PEN PEP PER
PES PET PEW PHI PHO PIA PIC PIE PIG PIN PIP PIS PIT PIU PIX PLY POD
POI POL POM POP POT POW POX PRO PRY PUB PUD PUG PUL PUN PUP PUR PUS
PUT PYA PYE PYX QAT QUA RAD RAG RAH RAI RAJ RAM RAN RAP RAS RAT RAW
RAX RAY REB REC RED REE REF REG REI REM REP RES RET REV REX RHO RIA
RIB RID RIF RIG RIM RIN RIP ROB ROC ROD ROE ROM ROT ROW RUB RUE RUG
RUM RUN RUT RYA RYE SAB SAC SAD SAE SAG SAL SAP SAT SAU SAW SAX SAY
SEA SEC SEE SEG SEI SEL SEN SER SET SEW SHA SHE SHH SHY SIB SIC SIM
SIN SIP SIR SIS SIT SIX SKA SKI SKY SLY SOB SOD SOL SOM SON SOP SOS
SOT SOU SOW SOX SOY SPA SPY STY SUB SUE SUM SUN SUP SUQ TAB TAD TAE
TAG TAJ TAM TAN TAO TAP TAR TAS TAT TAU TAV TAW TAX TEA TED TEE TEG
TEN TET TEW THE THO THY TIC TIE TIN TIP TIS TIT TOD TOE TOG TOM TON
TOO TOP TOR TOT TOW TOY TSK TUB TUG TUI TUN TUP TUT TUX TWA TWO TYE
UDO UGH UKE ULU UMP UNI UNS UPO UPS URB URD URN URP URS USE UTA UTE
UTS VAC VAN VAR VAS VAT VAU VAV VAW VEE VEG VET VEX VIA VID VIE VIG
VIM VIS VOW VOX VUG WAB WAD WAE WAG WAN WAP WAR WAS WAT WAW WAX WAY
WEB WED WEE WEN WET WHA WHO WHY WIG WIN WIS WIT WIZ WOE WOG WOK WON
WOO WOP WOS WOT WOW YAH YAM YAP YAW YAY YEA YEH YEN YEP YES YET YEW
YID YIN YIP YOB YOD YOK YOM YON YOU YOW YUK YUM YUP ZAG ZAP ZAX ZED
ZEE ZEK ZEN ZEP ZIG ZIN ZIP ZIT ZOA ZOO
ABLE ACHE ACID ACME ACRE AGED AIDE AJAR ALLY ALSO AMOK ANTS AQUA ARCH
AREA ARMY AVID AXLE BABE BACK BADE BAKE BALD BALE BALL BALM BAND BANE
BANG BANK BARE BARK BARN BASE BASH BASK BASS BATH BAWL BEAD BEAK BEAM
BEAN BEAR BEAT BEEF BEEN BEER BELL BELT BEND BENT BEST BIAS BIKE BILL
BIND BIRD BITE BLOW BLUE BLUR BOAR BOAT BODY BOIL BOLD BOLT BOMB BOND
BONE BOOK BOOM BOOT BORE BORN BOSS BOTH BOUT BOWL BRED BREW BRIM BULK
BULL BUMP BURN BURP BURY BUSH BUST BUSY CAFE CAGE CAKE CALF CALM CAME
CAMP CANE CAPE CARD CARE CART CASE CASH CAST CAVE CHAT CHEW CHIN CHIP
CHOP CITE CLAM CLAP CLAW CLAY CLIP CLOD CLOG CLOT CLUB CLUE COAL COAT
CODE COIL COIN COLD COLE COLT COMB COME CONE COOK COOL COPE COPY CORD
CORE CORK CORN COST COZY CRAB CREW CROP CROW CUBE CULT CURB CURE CURL
CUTE DAFT DALE DAME DAMP DARE DARK DARN DART DASH DATA DATE DAWN DEAD
DEAF DEAL DEAR DECK DEED DEEM DEEP DEER DEFT DEMO DENY DESK DICE DIET
DIME DINE DIRE DIRT DISC DISH DISK DIVE DOCK DOES DOLE DOME DONE DOOM
DOOR DOSE DOVE DOWN DRAB DRAG DRAW DREW DRIP DROP DRUM DUAL DUBS DUCK
DUDE DUEL DUET DUKE DULL DUMB DUMP DUNE DUNK DUPE DUST DUTY DYED EACH
EARL EARN EASE EAST EASY EDGE EDIT ELSE EMIT ENVY EPIC EVEN EVER EVIL
EXAM EXEC FACE FACT FADE FAIL FAIR FAKE FALL FAME FANG FARE FARM FAST
FATE FAWN FEAR FEAT FEED FEEL FEET FILE FILL FILM FIND FINE FIRE FIRM
FISH FIST FLAG FLAK FLAM FLAN FLAP FLAT FLAW FLEA FLED FLEW FLEX FLIP
FLIT FLOG FLOP FLOW FLUX FOAM FOAL FOES FOIL FOLD FOLK FOND FONT FOOD
FOOL FOOT FORD FORE FORK FORM FORT FOUL FOUR FOWL FREE FROM FUEL FULL
FUME FUND FUNK FURY FUSE FUSS FUZZ GAIT GALE GALL GAME GANG GAPE GARB
GASH GASP GATE GAVE GAZE GEAR GELD GENE GIFT GILD GIST GIVE GLAD GLEN
GLIB GLOB GLOM GLOW GLUE GLUM GLUT GNAT GNAW GOAD GOAL GOAT GOES GOLD
GOLF GONE GOOD GORE GORY GOWN GRAB GRAM GRAY GREW GRID GRIM GRIN GRIP
GRIT GROW GRUB GULF GULL GULP GUST GUTS HACK HAIL HAIR HALE HALF HALL
HALT HAND HANG HARE HARK HARM HARP HASH HASP HAST HATE HAUL HAVE HAWK
HAZE HAZY HEAD HEAL HEAP HEAR HEAT HEED HEEL HELD HELM HELP HERB HERD
HERE HERO HIKE HILL HILT HIND HINT HIRE HISS HIVE HOAX HOCK HOLD HOLE
HOME HONE HOOD HOOK HOOP HOPE HORN HOSE HOST HOUR HOWL HUBS HUED HUGE
HULK HULL HUMP HUNG HUNT HURL HURT HUSK HYMN ICON IDEA IDLE INCH INTO
IRON ISLE ITEM JADE JAIL JAMB JAPE JARS JAVA JAWS JAZZ JEAN JEER JERK
JEST JIBE JIGS JILT JINX JIVE JOBS JOCK JOGS JOIN JOKE JOLT JOSH JOWL
JOYS JUDO JUGS JUMP JUNK JURY JUST JUTE KALE KEEN KEEP KELP KEPT KEYS
KICK KIDS KILL KILN KILT KINE KIND KING KINK KISS KITE KNAB KNAP KNEE
KNEW KNIT KNOB KNOT KNOW KNUR LACE LACK LACY LAID LAIR LAKE LAMB LAME
LAMP LAND LANE LARD LARK LASH LASS LAST LATE LAUD LAWN LAWS LAZY LEAD
LEAF LEAK LEAN LEAP LEFT LEND LENS LENT LESS LIAR LICE LICK LIED LIEU
LIFE LIFT LIKE LIMB LIME LIMP LINE LINK LINT LION LISP LIST LIVE LOAD
LOAF LOAM LOAN LOBE LOCK LODE LOFT LOGE LOGO LONE LONG LOOK LOOM LOOP
LOOT LORD LORE LORN LOSE LOSS LOST LOUD LOVE LUCK LULL LUMP LURE LURK
LUSH LUST LYNX LYRE MACE MAID MAIL MAIN MAKE MALE MALL MALT MANE MANY
MARE MARK MARS MASH MASK MASS MAST MATE MATH MAUL MAZE MEAD MEAL MEAN
MEAT MEEK MEET MELD MELT MEMO MEND MENU MESH MESS MICA MILD MILK MILL
MIME MIND MINE MINK MINT MIRE MISS MIST MITE MITT MOAN MOAT MOCK MODE
MOLD MOLE MOLT MONK MOOD MOON MOOR MOPE MORE MOSS MOST MOTH MOVE MUCH
MUCK MUFF MULE MULL MUNG MUSE MUSH MUSK MUST MUTE MYTH
QUIET QUAIL QUALM QUERY QUEUE QUICK QUILL QUIRK QUILT QUOTA QUOTE
ZEBRA ZESTY ZILCH ZIPPY ZONAL
""".strip()


class ScrabbleDictionary:
    """Scrabble word validator with O(1) lookup."""

    def __init__(self) -> None:
        self._words: set[str] = set()
        self._load()

    def _load(self) -> None:
        """Load TWL06; fall back to common-words list."""
        if _TWL06_PATH.exists():
            try:
                text = _TWL06_PATH.read_text()
                for line in text.splitlines():
                    word = line.strip().upper()
                    if word and word.isalpha():
                        self._words.add(word)
                if len(self._words) > 1000:
                    return  # loaded successfully
            except OSError:
                pass
        # Fallback
        self._words.clear()
        for word in _FALLBACK_WORDS.split():
            self._words.add(word.upper())

    def is_valid(self, word: str) -> bool:
        """Check if a word is in the dictionary."""
        return word.upper() in self._words

    def __len__(self) -> int:
        return len(self._words)

    def __contains__(self, word: str) -> bool:
        return self.is_valid(word)
